<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÈúìËôπÊãâÈú∏ ‚Äî NEON SLOTS</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --cyan: #00f0ff;
            --magenta: #ff2d95;
            --violet: #b026ff;
            --gold: #ffd700;
            --dark: #0a0a1a;
            --glass: rgba(255,255,255,0.04);
            --radius: 16px;
        }
        * { margin:0; padding:0; box-sizing:border-box; }
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background: var(--dark);
            color: #e0e0f0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 16px;
            overflow-x: hidden;
        }
        body::before {
            content:'';
            position:fixed; inset:0;
            background:
                radial-gradient(ellipse 600px 400px at 30% 20%, rgba(0,240,255,.06) 0%, transparent 70%),
                radial-gradient(ellipse 500px 500px at 70% 80%, rgba(255,45,149,.05) 0%, transparent 70%);
            z-index:0;
        }
        body::after {
            content:'';
            position:fixed; inset:0;
            background-image:
                linear-gradient(rgba(0,240,255,.025) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0,240,255,.025) 1px, transparent 1px);
            background-size: 60px 60px;
            z-index:0; pointer-events:none;
        }
        .container { max-width:480px; width:100%; position:relative; z-index:1; }

        /* Header */
        h1 {
            font-family:'Orbitron',sans-serif;
            font-weight:900; font-size:2rem; letter-spacing:4px;
            text-align:center;
            background: linear-gradient(135deg, var(--cyan), var(--magenta));
            -webkit-background-clip:text; -webkit-text-fill-color:transparent;
            background-clip:text;
            filter: drop-shadow(0 0 20px rgba(0,240,255,.3));
            text-transform:uppercase;
        }
        .subtitle {
            font-family:'Orbitron',sans-serif;
            font-size:.65rem; letter-spacing:5px; text-align:center;
            color:rgba(255,255,255,.3); margin:4px 0 16px; text-transform:uppercase;
        }

        /* Credits */
        .credits-bar {
            display:flex; justify-content:space-between; align-items:center;
            background:var(--glass); border:1px solid rgba(255,255,255,.06);
            border-radius:12px; padding:12px 20px; margin-bottom:16px;
            backdrop-filter:blur(20px);
        }
        .credits-label {
            font-family:'Orbitron',sans-serif;
            font-size:.6rem; letter-spacing:2px; color:rgba(255,255,255,.35);
            text-transform:uppercase;
        }
        .credits-value {
            font-family:'Orbitron',sans-serif;
            font-size:1.6rem; font-weight:700; color:var(--gold);
            text-shadow: 0 0 10px rgba(255,215,0,.3);
        }
        .win-display {
            font-family:'Orbitron',sans-serif;
            font-size:1rem; font-weight:700; color:var(--cyan);
            opacity:0; transition: opacity .3s;
        }
        .win-display.show { opacity:1; }

        /* Slot Machine */
        .machine {
            background: linear-gradient(180deg, #12122e 0%, #0a0a1e 100%);
            border: 1.5px solid rgba(0,240,255,.15);
            border-radius: 20px;
            padding: 24px 16px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 40px rgba(0,240,255,.08), inset 0 0 60px rgba(0,0,0,.5);
        }
        .machine::before {
            content:'';
            position:absolute; top:0; left:0; right:0; height:1px;
            background: linear-gradient(90deg, transparent, var(--cyan), transparent);
        }

        /* Reels */
        .reels-window {
            display:flex; gap:8px; justify-content:center;
            height: 240px;
            overflow: hidden;
            border-radius: 12px;
            background: #060612;
            border: 1px solid rgba(255,255,255,.05);
            position: relative;
            margin-bottom: 20px;
        }
        /* Gradient masks top/bottom */
        .reels-window::before, .reels-window::after {
            content:'';
            position:absolute; left:0; right:0; height:60px; z-index:2;
            pointer-events:none;
        }
        .reels-window::before {
            top:0;
            background: linear-gradient(to bottom, #060612 0%, transparent 100%);
        }
        .reels-window::after {
            bottom:0;
            background: linear-gradient(to top, #060612 0%, transparent 100%);
        }
        /* Payline indicator */
        .payline {
            position:absolute; top:50%; left:0; right:0;
            height:80px; transform:translateY(-50%);
            border-top: 2px solid rgba(0,240,255,.3);
            border-bottom: 2px solid rgba(0,240,255,.3);
            z-index:3; pointer-events:none;
            box-shadow: inset 0 0 20px rgba(0,240,255,.05);
        }
        .payline::before, .payline::after {
            content:'‚óÜ'; position:absolute; top:50%; transform:translateY(-50%);
            font-size:.6rem; color:var(--cyan);
        }
        .payline::before { left:6px; }
        .payline::after { right:6px; }

        .reel {
            flex:1; display:flex; flex-direction:column; align-items:center;
            position:relative;
        }
        .reel-strip {
            display:flex; flex-direction:column; align-items:center;
            transition: transform 0s;
            will-change: transform;
        }
        .reel-symbol {
            width:100%; height:80px;
            display:flex; align-items:center; justify-content:center;
            font-size:3rem;
            flex-shrink:0;
        }

        /* Dividers between reels */
        .reel + .reel { border-left: 1px solid rgba(255,255,255,.04); }

        /* Controls */
        .controls {
            display:flex; flex-direction:column; gap:12px; align-items:center;
        }
        .bet-row {
            display:flex; align-items:center; gap:10px;
        }
        .bet-label {
            font-family:'Orbitron',sans-serif;
            font-size:.6rem; letter-spacing:2px; color:rgba(255,255,255,.35);
            text-transform:uppercase;
        }
        .bet-buttons { display:flex; gap:6px; }
        .bet-btn {
            font-family:'Orbitron',sans-serif;
            font-size:.65rem; padding:8px 14px;
            border:1px solid rgba(255,255,255,.1);
            background:var(--glass); color:rgba(255,255,255,.5);
            border-radius:100px; cursor:pointer; transition:all .3s;
            backdrop-filter:blur(10px);
        }
        .bet-btn:hover { border-color:var(--cyan); color:var(--cyan); }
        .bet-btn.active {
            border-color:var(--gold); color:var(--gold);
            background:rgba(255,215,0,.1);
            box-shadow: 0 0 15px rgba(255,215,0,.2);
        }

        .action-row { display:flex; gap:12px; align-items:center; }

        .spin-btn {
            font-family:'Orbitron',sans-serif;
            font-size:.8rem; font-weight:700; letter-spacing:3px;
            text-transform:uppercase;
            padding:16px 48px;
            border:none; border-radius:100px;
            background: linear-gradient(135deg, var(--cyan), var(--magenta));
            color:#fff; cursor:pointer;
            box-shadow: 0 0 30px rgba(0,240,255,.3);
            transition: all .3s;
            position:relative; overflow:hidden;
        }
        .spin-btn:hover {
            transform:translateY(-2px);
            box-shadow: 0 0 40px rgba(0,240,255,.5);
        }
        .spin-btn:active { transform:scale(.97); }
        .spin-btn:disabled {
            opacity:.4; cursor:not-allowed; transform:none;
            box-shadow:none;
        }
        .spin-btn::after {
            content:'';
            position:absolute; inset:0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,.2), transparent);
            transform:translateX(-100%);
        }
        .spin-btn.spinning::after {
            animation: shimmer 1s infinite;
        }
        @keyframes shimmer {
            to { transform:translateX(100%); }
        }

        .auto-btn {
            font-family:'Orbitron',sans-serif;
            font-size:.6rem; letter-spacing:1px; padding:14px 20px;
            border:1px solid rgba(255,255,255,.1);
            background:var(--glass); color:rgba(255,255,255,.4);
            border-radius:100px; cursor:pointer; transition:all .3s;
        }
        .auto-btn:hover { border-color:var(--violet); color:var(--violet); }
        .auto-btn.active {
            border-color:var(--violet); color:var(--violet);
            background:rgba(176,38,255,.15);
            box-shadow: 0 0 15px rgba(176,38,255,.2);
        }

        /* Payout Table */
        .payout-toggle {
            font-family:'Orbitron',sans-serif;
            font-size:.6rem; letter-spacing:2px; text-transform:uppercase;
            color:rgba(255,255,255,.3); cursor:pointer;
            text-align:center; margin-top:16px; transition:color .3s;
        }
        .payout-toggle:hover { color:var(--cyan); }

        .payout-table {
            display:none; margin-top:12px;
            background:var(--glass); border:1px solid rgba(255,255,255,.06);
            border-radius:12px; padding:16px; backdrop-filter:blur(20px);
        }
        .payout-table.show { display:block; }
        .payout-title {
            font-family:'Orbitron',sans-serif;
            font-size:.65rem; letter-spacing:2px; color:var(--cyan);
            text-align:center; margin-bottom:12px; text-transform:uppercase;
        }
        .payout-row {
            display:flex; justify-content:space-between; align-items:center;
            padding:6px 0;
            border-bottom: 1px solid rgba(255,255,255,.03);
        }
        .payout-row:last-child { border-bottom:none; }
        .payout-symbols { font-size:1.2rem; }
        .payout-mult {
            font-family:'Orbitron',sans-serif;
            font-size:.75rem; font-weight:700; color:var(--gold);
        }

        /* History */
        .history {
            margin-top:16px;
            background:var(--glass); border:1px solid rgba(255,255,255,.06);
            border-radius:12px; padding:14px; backdrop-filter:blur(20px);
            max-height:180px; overflow-y:auto;
        }
        .history-title {
            font-family:'Orbitron',sans-serif;
            font-size:.6rem; letter-spacing:2px; color:rgba(255,255,255,.3);
            margin-bottom:8px; text-transform:uppercase;
        }
        .history-entry {
            display:flex; justify-content:space-between; align-items:center;
            padding:4px 0; font-size:.85rem;
            border-bottom: 1px solid rgba(255,255,255,.02);
        }
        .history-entry:last-child { border-bottom:none; }
        .history-result { letter-spacing:4px; }
        .history-win { font-family:'Orbitron',sans-serif; font-size:.7rem; font-weight:700; }
        .history-win.positive { color:var(--gold); }
        .history-win.negative { color:rgba(255,255,255,.2); }

        /* Jackpot overlay */
        .jackpot-overlay {
            position:fixed; inset:0;
            background:rgba(6,6,18,.9);
            backdrop-filter:blur(20px);
            display:none; align-items:center; justify-content:center;
            z-index:100;
        }
        .jackpot-overlay.show { display:flex; }
        .jackpot-content {
            text-align:center;
            animation: jackpotIn .6s cubic-bezier(.4,0,.2,1);
        }
        @keyframes jackpotIn {
            from { transform:scale(.5) translateY(40px); opacity:0; }
            to { transform:scale(1) translateY(0); opacity:1; }
        }
        .jackpot-emoji { font-size:5rem; margin-bottom:12px; }
        .jackpot-title {
            font-family:'Orbitron',sans-serif;
            font-size:2rem; font-weight:900; letter-spacing:4px;
            background: linear-gradient(135deg, var(--gold), #ff8c00);
            -webkit-background-clip:text; -webkit-text-fill-color:transparent;
            background-clip:text;
            animation: jackpotPulse 1s ease-in-out infinite alternate;
        }
        @keyframes jackpotPulse {
            to { filter: drop-shadow(0 0 20px rgba(255,215,0,.5)); transform:scale(1.05); }
        }
        .jackpot-amount {
            font-family:'Orbitron',sans-serif;
            font-size:3rem; font-weight:900; color:var(--gold);
            margin:16px 0;
            text-shadow: 0 0 20px rgba(255,215,0,.4);
        }
        .jackpot-close {
            font-family:'Orbitron',sans-serif;
            font-size:.7rem; letter-spacing:3px; text-transform:uppercase;
            padding:14px 36px;
            border:1.5px solid var(--gold);
            background:transparent; color:var(--gold);
            border-radius:100px; cursor:pointer;
            transition:all .3s;
        }
        .jackpot-close:hover {
            background:rgba(255,215,0,.1);
            box-shadow: 0 0 20px rgba(255,215,0,.3);
        }

        /* Particle */
        .particle {
            position:fixed; border-radius:50%;
            pointer-events:none; z-index:101;
        }

        /* Win flash on reels */
        .reels-window.win-flash {
            animation: reelFlash .3s ease-in-out 3;
        }
        @keyframes reelFlash {
            50% { box-shadow: inset 0 0 40px rgba(255,215,0,.2); border-color: rgba(255,215,0,.3); }
        }

        /* Responsive */
        @media (max-width:500px) {
            h1 { font-size:1.5rem; letter-spacing:2px; }
            .reel-symbol { height:65px; font-size:2.4rem; }
            .reels-window { height:195px; }
            .payline { height:65px; }
            .spin-btn { padding:14px 36px; font-size:.7rem; }
            .credits-value { font-size:1.3rem; }
        }
        @media (max-width:380px) {
            .reel-symbol { height:55px; font-size:2rem; }
            .reels-window { height:165px; }
            .payline { height:55px; }
        }

        /* Scrollbar */
        .history::-webkit-scrollbar { width:4px; }
        .history::-webkit-scrollbar-track { background:transparent; }
        .history::-webkit-scrollbar-thumb { background:rgba(255,255,255,.1); border-radius:4px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Neon Slots</h1>
        <div class="subtitle">ÈúìËôπÊãâÈú∏Ê©ü</div>

        <div class="credits-bar">
            <div>
                <div class="credits-label">Á±åÁ¢º</div>
                <div class="credits-value" id="credits">1,000</div>
            </div>
            <div class="win-display" id="winDisplay">+0</div>
            <div>
                <div class="credits-label">‰∏ãÊ≥®</div>
                <div class="credits-value" id="betDisplay" style="color:var(--cyan); font-size:1.2rem;">50</div>
            </div>
        </div>

        <div class="machine">
            <div class="reels-window" id="reelsWindow">
                <div class="payline"></div>
                <div class="reel" id="reel0"><div class="reel-strip"></div></div>
                <div class="reel" id="reel1"><div class="reel-strip"></div></div>
                <div class="reel" id="reel2"><div class="reel-strip"></div></div>
            </div>

            <div class="controls">
                <div class="bet-row">
                    <span class="bet-label">‰∏ãÊ≥®</span>
                    <div class="bet-buttons">
                        <button class="bet-btn" data-bet="10">10</button>
                        <button class="bet-btn active" data-bet="50">50</button>
                        <button class="bet-btn" data-bet="100">100</button>
                        <button class="bet-btn" data-bet="500">500</button>
                    </div>
                </div>
                <div class="action-row">
                    <button class="spin-btn" id="spinBtn" onclick="spin()">ÊãâÈú∏</button>
                    <button class="auto-btn" id="autoBtn" onclick="toggleAuto()">Ëá™Âãï</button>
                </div>
            </div>
        </div>

        <div class="payout-toggle" onclick="togglePayout()">‚ñº Ë≥†ÁéáË°® ‚ñº</div>
        <div class="payout-table" id="payoutTable">
            <div class="payout-title">Ë≥†ÁéáË°®</div>
            <div class="payout-row"><span class="payout-symbols">7Ô∏è‚É£ 7Ô∏è‚É£ 7Ô∏è‚É£</span><span class="payout-mult">√ó50 Â§ßÁçé</span></div>
            <div class="payout-row"><span class="payout-symbols">üíé üíé üíé</span><span class="payout-mult">√ó30</span></div>
            <div class="payout-row"><span class="payout-symbols">üé∞ üé∞ üé∞</span><span class="payout-mult">√ó20</span></div>
            <div class="payout-row"><span class="payout-symbols">‚≠ê ‚≠ê ‚≠ê</span><span class="payout-mult">√ó15</span></div>
            <div class="payout-row"><span class="payout-symbols">üîî üîî üîî</span><span class="payout-mult">√ó10</span></div>
            <div class="payout-row"><span class="payout-symbols">üçÄ üçÄ üçÄ</span><span class="payout-mult">√ó8</span></div>
            <div class="payout-row"><span class="payout-symbols">üçí üçí üçí</span><span class="payout-mult">√ó5</span></div>
            <div class="payout-row"><span class="payout-symbols">üçã üçã üçã</span><span class="payout-mult">√ó3</span></div>
            <div class="payout-row"><span class="payout-symbols">‰ªªÊÑèÂÖ©ÂÄãÁõ∏Âêå</span><span class="payout-mult">√ó1</span></div>
        </div>

        <div class="history" id="history" style="display:none;">
            <div class="history-title">Ê≠∑Âè≤Á¥ÄÈåÑ</div>
            <div id="historyList"></div>
        </div>
    </div>

    <div class="jackpot-overlay" id="jackpotOverlay">
        <div class="jackpot-content">
            <div class="jackpot-emoji">üé∞</div>
            <div class="jackpot-title" id="jackpotTitle">JACKPOT</div>
            <div class="jackpot-amount" id="jackpotAmount">+0</div>
            <button class="jackpot-close" onclick="closeJackpot()">ÁπºÁ∫å</button>
        </div>
    </div>

    <script>
        const SYMBOLS = ['üçí','üçã','üîî','üíé','7Ô∏è‚É£','üçÄ','‚≠ê','üé∞'];
        const WEIGHTS = [25, 20, 16, 10, 5, 14, 8, 6]; // higher = more common
        const PAYOUTS = {
            '7Ô∏è‚É£': 50, 'üíé': 30, 'üé∞': 20, '‚≠ê': 15,
            'üîî': 10, 'üçÄ': 8, 'üçí': 5, 'üçã': 3
        };

        let credits = 1000;
        let bet = 50;
        let spinning = false;
        let autoSpin = false;
        let history = [];
        const VISIBLE = 3; // symbols visible
        const SYMBOL_H = 80; // must match CSS
        const EXTRA = 30; // extra symbols for spin strip

        // Audio context
        let audioCtx;
        function getAudio() {
            if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            return audioCtx;
        }
        function playTone(freq, dur, type='square', vol=0.08) {
            const ctx = getAudio();
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.type = type;
            osc.frequency.value = freq;
            gain.gain.setValueAtTime(vol, ctx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + dur);
            osc.connect(gain); gain.connect(ctx.destination);
            osc.start(); osc.stop(ctx.currentTime + dur);
        }
        function playSpinTick() { playTone(800 + Math.random()*400, 0.03, 'square', 0.04); }
        function playStop() { playTone(600, 0.1, 'sine', 0.1); }
        function playWin() {
            [523,659,784,1047].forEach((f,i) => setTimeout(() => playTone(f, 0.2, 'sine', 0.1), i*100));
        }
        function playJackpot() {
            [523,659,784,1047,1319,1568].forEach((f,i) => setTimeout(() => playTone(f, 0.3, 'sine', 0.12), i*120));
        }
        function playLose() { playTone(200, 0.15, 'triangle', 0.06); }

        // Weighted random symbol
        function randomSymbol() {
            const total = WEIGHTS.reduce((a,b) => a+b, 0);
            let r = Math.random() * total;
            for (let i = 0; i < SYMBOLS.length; i++) {
                r -= WEIGHTS[i];
                if (r <= 0) return SYMBOLS[i];
            }
            return SYMBOLS[0];
        }

        // Build reel strip
        function buildStrip(finalSymbol) {
            const strip = [];
            for (let i = 0; i < EXTRA; i++) strip.push(randomSymbol());
            // Place final symbols at positions that align with payline
            strip.push(randomSymbol()); // top visible
            strip.push(finalSymbol);    // center (payline)
            strip.push(randomSymbol()); // bottom visible
            return strip;
        }

        // Init reels with random display
        function initReels() {
            for (let i = 0; i < 3; i++) {
                const strip = document.querySelector(`#reel${i} .reel-strip`);
                strip.innerHTML = '';
                const syms = [randomSymbol(), randomSymbol(), randomSymbol()];
                syms.forEach(s => {
                    const div = document.createElement('div');
                    div.className = 'reel-symbol';
                    div.textContent = s;
                    strip.appendChild(div);
                });
                strip.style.transition = 'none';
                strip.style.transform = 'translateY(0)';
            }
        }

        // Spin
        function spin() {
            if (spinning) return;
            if (credits < bet) {
                shakeCredits();
                return;
            }

            spinning = true;
            credits -= bet;
            updateCredits();
            hideWinDisplay();

            const spinBtn = document.getElementById('spinBtn');
            spinBtn.disabled = true;
            spinBtn.classList.add('spinning');
            spinBtn.textContent = 'ËΩâÂãï‰∏≠...';

            // Determine results
            const results = [randomSymbol(), randomSymbol(), randomSymbol()];

            // Build strips and animate
            const delays = [1200, 1600, 2000];
            const strips = [];

            for (let i = 0; i < 3; i++) {
                const stripData = buildStrip(results[i]);
                const stripEl = document.querySelector(`#reel${i} .reel-strip`);
                stripEl.innerHTML = '';
                stripData.forEach(s => {
                    const div = document.createElement('div');
                    div.className = 'reel-symbol';
                    div.textContent = s;
                    stripEl.appendChild(div);
                });

                // Start at top
                stripEl.style.transition = 'none';
                stripEl.style.transform = 'translateY(0)';
                strips.push({ el: stripEl, data: stripData, delay: delays[i] });
            }

            // Animate each reel
            requestAnimationFrame(() => {
                strips.forEach((s, i) => {
                    const totalSymbols = s.data.length;
                    // We want the center (payline) symbol to be at index totalSymbols-2
                    // Offset = (totalSymbols - 2) * SYMBOL_H - SYMBOL_H (to center in view)
                    const mobileH = window.innerWidth <= 500 ? (window.innerWidth <= 380 ? 55 : 65) : 80;
                    const targetOffset = (totalSymbols - 2) * mobileH - mobileH;

                    setTimeout(() => {
                        s.el.style.transition = `transform ${s.delay/1000}s cubic-bezier(.2,.8,.3,1)`;
                        s.el.style.transform = `translateY(-${targetOffset}px)`;
                    }, 50);

                    setTimeout(() => {
                        playStop();
                    }, s.delay + 50);
                });
            });

            // Tick sounds during spin
            let tickInterval = setInterval(playSpinTick, 80);
            setTimeout(() => clearInterval(tickInterval), delays[2]);

            // Evaluate after last reel stops
            setTimeout(() => {
                evaluate(results);
                spinning = false;
                spinBtn.disabled = false;
                spinBtn.classList.remove('spinning');
                spinBtn.textContent = 'ÊãâÈú∏';

                if (autoSpin && credits >= bet) {
                    setTimeout(spin, 800);
                } else if (autoSpin) {
                    toggleAuto();
                }
            }, delays[2] + 200);
        }

        function evaluate(results) {
            const [a, b, c] = results;
            let winAmount = 0;
            let isJackpot = false;

            if (a === b && b === c) {
                // Triple match
                const mult = PAYOUTS[a] || 3;
                winAmount = bet * mult;
                if (a === '7Ô∏è‚É£') isJackpot = true;
            } else if (a === b || b === c || a === c) {
                // Any two match
                winAmount = bet * 1;
            }

            credits += winAmount;
            updateCredits();
            addHistory(results, winAmount);

            if (isJackpot) {
                showJackpot(winAmount);
                playJackpot();
                spawnParticles(40);
            } else if (winAmount > 0) {
                showWin(winAmount);
                playWin();
                document.getElementById('reelsWindow').classList.add('win-flash');
                setTimeout(() => document.getElementById('reelsWindow').classList.remove('win-flash'), 1000);
                if (winAmount >= bet * 10) spawnParticles(20);
            } else {
                playLose();
            }
        }

        function updateCredits() {
            document.getElementById('credits').textContent = credits.toLocaleString();
        }

        function showWin(amount) {
            const el = document.getElementById('winDisplay');
            el.textContent = '+' + amount.toLocaleString();
            el.classList.add('show');
            el.style.color = amount >= bet * 10 ? 'var(--gold)' : 'var(--cyan)';
        }

        function hideWinDisplay() {
            document.getElementById('winDisplay').classList.remove('show');
        }

        function shakeCredits() {
            const el = document.querySelector('.credits-bar');
            el.style.animation = 'none';
            el.offsetHeight;
            el.style.animation = 'shake .4s ease-in-out';
            playTone(150, 0.2, 'sawtooth', 0.06);
        }

        function showJackpot(amount) {
            const overlay = document.getElementById('jackpotOverlay');
            document.getElementById('jackpotAmount').textContent = '+' + amount.toLocaleString();
            if (amount >= bet * 30) {
                document.getElementById('jackpotTitle').textContent = 'üî• MEGA JACKPOT üî•';
                document.querySelector('.jackpot-emoji').textContent = 'üí∞';
            } else {
                document.getElementById('jackpotTitle').textContent = 'JACKPOT!';
                document.querySelector('.jackpot-emoji').textContent = 'üé∞';
            }
            overlay.classList.add('show');
        }

        function closeJackpot() {
            document.getElementById('jackpotOverlay').classList.remove('show');
        }

        function spawnParticles(count) {
            const colors = ['#00f0ff','#ff2d95','#b026ff','#ffd700','#fff'];
            for (let i = 0; i < count; i++) {
                setTimeout(() => {
                    const p = document.createElement('div');
                    p.className = 'particle';
                    p.style.left = (20 + Math.random()*60) + 'vw';
                    p.style.top = (20 + Math.random()*40) + 'vh';
                    p.style.width = p.style.height = (3 + Math.random()*5) + 'px';
                    p.style.background = colors[Math.floor(Math.random()*colors.length)];
                    p.style.transition = `all ${1+Math.random()}s ease-out`;
                    document.body.appendChild(p);
                    requestAnimationFrame(() => {
                        p.style.transform = `translate(${(Math.random()-.5)*200}px, ${(Math.random()-.5)*200}px)`;
                        p.style.opacity = '0';
                    });
                    setTimeout(() => p.remove(), 2000);
                }, i * 40);
            }
        }

        // Bet buttons
        document.querySelectorAll('.bet-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                if (spinning) return;
                document.querySelectorAll('.bet-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                bet = parseInt(btn.dataset.bet);
                document.getElementById('betDisplay').textContent = bet;
                playTone(1000, 0.05, 'sine', 0.05);
            });
        });

        // Auto spin
        function toggleAuto() {
            autoSpin = !autoSpin;
            const btn = document.getElementById('autoBtn');
            btn.classList.toggle('active', autoSpin);
            btn.textContent = autoSpin ? 'ÂÅúÊ≠¢' : 'Ëá™Âãï';
            if (autoSpin && !spinning) spin();
        }

        // Payout table toggle
        function togglePayout() {
            document.getElementById('payoutTable').classList.toggle('show');
        }

        // History
        function addHistory(results, winAmount) {
            history.unshift({ symbols: results.join(' '), win: winAmount });
            if (history.length > 10) history.pop();
            renderHistory();
        }

        function renderHistory() {
            const container = document.getElementById('history');
            const list = document.getElementById('historyList');
            container.style.display = history.length ? 'block' : 'none';
            list.innerHTML = history.map(h => `
                <div class="history-entry">
                    <span class="history-result">${h.symbols}</span>
                    <span class="history-win ${h.win > 0 ? 'positive' : 'negative'}">${h.win > 0 ? '+'+h.win.toLocaleString() : '-'+bet}</span>
                </div>
            `).join('');
        }

        // Keyboard shortcut
        document.addEventListener('keydown', e => {
            if (e.code === 'Space') { e.preventDefault(); spin(); }
        });

        // Add shake animation
        const style = document.createElement('style');
        style.textContent = `@keyframes shake { 0%,100%{transform:translateX(0)} 25%{transform:translateX(-6px)} 75%{transform:translateX(6px)} }`;
        document.head.appendChild(style);

        initReels();
    </script>
</body>
</html>
