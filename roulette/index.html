<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>霓虹輪盤 - Neon Roulette</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--cyan:#00f0ff;--magenta:#ff2d95;--violet:#b026ff;--gold:#ffd700;--dark:#0a0a1a;--glass:rgba(255,255,255,0.05)}
body{background:var(--dark);color:#fff;font-family:'Noto Sans TC',sans-serif;min-height:100vh;overflow-x:hidden;position:relative}
body::before{content:'';position:fixed;inset:0;background:radial-gradient(ellipse at 30% 20%,rgba(0,240,255,0.08) 0%,transparent 50%),radial-gradient(ellipse at 70% 80%,rgba(255,45,149,0.08) 0%,transparent 50%),radial-gradient(ellipse at 50% 50%,rgba(176,38,255,0.05) 0%,transparent 60%);z-index:0;pointer-events:none}
body::after{content:'';position:fixed;inset:0;background-image:linear-gradient(rgba(255,255,255,0.03) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.03) 1px,transparent 1px);background-size:60px 60px;z-index:0;pointer-events:none}
h1,h2,h3,.orbitron{font-family:'Orbitron',sans-serif}
.container{position:relative;z-index:1;max-width:1200px;margin:0 auto;padding:10px}
header{text-align:center;padding:15px 0}
header h1{font-size:clamp(1.5rem,4vw,2.5rem);background:linear-gradient(90deg,var(--cyan),var(--magenta),var(--violet));-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-shadow:none;letter-spacing:4px}
header p{color:var(--cyan);opacity:0.7;margin-top:4px;font-size:0.85rem}
.glass{background:rgba(255,255,255,0.05);backdrop-filter:blur(16px);-webkit-backdrop-filter:blur(16px);border:1px solid rgba(255,255,255,0.08);border-radius:16px}
.main-layout{display:flex;gap:15px;flex-wrap:wrap;justify-content:center;align-items:flex-start}
.left-panel{flex:0 0 340px;display:flex;flex-direction:column;gap:12px}
.right-panel{flex:1;min-width:300px;max-width:600px;display:flex;flex-direction:column;gap:12px}
/* Roulette Wheel */
.wheel-container{position:relative;width:300px;height:300px;margin:0 auto}
.wheel-outer{width:100%;height:100%;border-radius:50%;position:relative;border:3px solid var(--cyan);box-shadow:0 0 30px rgba(0,240,255,0.3),inset 0 0 30px rgba(0,240,255,0.1)}
.wheel-svg{width:100%;height:100%;transition:none}
.wheel-svg.spinning{transition:transform 4s cubic-bezier(0.17,0.67,0.12,0.99)}
.ball{position:absolute;width:12px;height:12px;background:radial-gradient(circle at 30% 30%,#fff,#ccc);border-radius:50%;top:50%;left:50%;margin:-6px;box-shadow:0 0 8px rgba(255,255,255,0.8);opacity:0;z-index:10}
.ball.show{opacity:1}
.ball.orbiting{animation:ballOrbit 0.4s linear infinite}
@keyframes ballOrbit{0%{transform:rotate(0deg) translateX(120px)}100%{transform:rotate(360deg) translateX(120px)}}
.ball.landing{transition:transform 1s ease-out;opacity:1}
.wheel-center{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:60px;height:60px;border-radius:50%;background:radial-gradient(circle,#1a1a2e,var(--dark));border:2px solid var(--cyan);display:flex;align-items:center;justify-content:center;font-family:'Orbitron';font-size:0.7rem;color:var(--cyan);z-index:5;text-align:center;line-height:1.2}
.marker{position:absolute;top:2px;left:50%;transform:translateX(-50%);width:0;height:0;border-left:8px solid transparent;border-right:8px solid transparent;border-top:16px solid var(--gold);z-index:20;filter:drop-shadow(0 0 6px var(--gold))}
/* Result display */
.result-display{text-align:center;padding:12px}
.result-number{font-family:'Orbitron';font-size:2.5rem;font-weight:900;text-shadow:0 0 20px currentColor}
.result-number.red{color:#ff4444}
.result-number.black{color:#fff}
.result-number.green{color:#00ff88}
.result-text{margin-top:4px;font-size:0.9rem;color:var(--cyan)}
/* Chip selector */
.chip-selector{display:flex;gap:8px;justify-content:center;padding:10px;flex-wrap:wrap}
.chip{width:52px;height:52px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-family:'Orbitron';font-size:0.7rem;font-weight:700;cursor:pointer;border:3px dashed rgba(255,255,255,0.3);transition:all 0.2s;position:relative;color:#fff}
.chip:hover{transform:scale(1.1)}
.chip.selected{border-style:solid;transform:scale(1.15);box-shadow:0 0 20px currentColor}
.chip-10{background:radial-gradient(circle at 35% 35%,#4488ff,#2255aa);border-color:#4488ff}
.chip-50{background:radial-gradient(circle at 35% 35%,#44cc44,#228822);border-color:#44cc44}
.chip-100{background:radial-gradient(circle at 35% 35%,#ff4444,#aa2222);border-color:#ff4444}
.chip-500{background:radial-gradient(circle at 35% 35%,#aa44ff,#6622aa);border-color:#aa44ff}
/* Betting table */
.bet-table{padding:12px}
.bet-table h3{color:var(--cyan);font-size:0.85rem;margin-bottom:8px;letter-spacing:2px}
.number-grid{display:grid;grid-template-columns:repeat(12,1fr);gap:3px;margin-bottom:10px}
.num-btn{padding:6px 2px;text-align:center;font-family:'Orbitron';font-size:0.65rem;font-weight:700;cursor:pointer;border:1px solid rgba(255,255,255,0.15);border-radius:4px;transition:all 0.15s;position:relative;min-height:32px;display:flex;align-items:center;justify-content:center}
.num-btn:hover{transform:scale(1.08);z-index:2}
.num-btn.red-num{background:rgba(200,30,30,0.6);color:#fff}
.num-btn.black-num{background:rgba(30,30,30,0.8);color:#fff}
.num-btn.green-num{background:rgba(0,150,60,0.6);color:#fff;grid-column:span 12}
.num-btn.has-bet{box-shadow:0 0 10px var(--gold);border-color:var(--gold)}
.num-btn .bet-indicator{position:absolute;top:-4px;right:-4px;width:16px;height:16px;background:var(--gold);border-radius:50%;font-size:0.45rem;display:flex;align-items:center;justify-content:center;color:#000;font-weight:900}
.outside-bets{display:grid;grid-template-columns:repeat(3,1fr);gap:6px;margin-top:8px}
.outside-btn{padding:10px 4px;text-align:center;font-family:'Orbitron';font-size:0.65rem;font-weight:700;cursor:pointer;border-radius:8px;border:1px solid rgba(255,255,255,0.15);background:var(--glass);transition:all 0.15s;letter-spacing:1px}
.outside-btn:hover{border-color:var(--cyan);box-shadow:0 0 10px rgba(0,240,255,0.3)}
.outside-btn.has-bet{border-color:var(--gold);box-shadow:0 0 10px rgba(255,215,0,0.4)}
.outside-btn.red-bg{background:rgba(200,30,30,0.3)}
.outside-btn.black-bg{background:rgba(50,50,50,0.5)}
/* Controls */
.controls{display:flex;gap:8px;justify-content:center;flex-wrap:wrap;padding:10px}
.btn{padding:10px 24px;border:none;border-radius:100px;font-family:'Orbitron';font-size:0.75rem;font-weight:700;letter-spacing:2px;cursor:pointer;transition:all 0.2s;text-transform:uppercase}
.btn-spin{background:linear-gradient(135deg,var(--cyan),var(--violet));color:#fff;box-shadow:0 0 20px rgba(0,240,255,0.3)}
.btn-spin:hover{box-shadow:0 0 30px rgba(0,240,255,0.5);transform:scale(1.05)}
.btn-spin:disabled{opacity:0.4;cursor:not-allowed;transform:none}
.btn-clear{background:rgba(255,45,149,0.2);color:var(--magenta);border:1px solid var(--magenta)}
.btn-clear:hover{background:rgba(255,45,149,0.3)}
/* Balance */
.balance-bar{display:flex;justify-content:space-between;align-items:center;padding:12px 16px}
.balance-label{font-size:0.75rem;color:rgba(255,255,255,0.6)}
.balance-amount{font-family:'Orbitron';font-size:1.3rem;font-weight:900;color:var(--gold);text-shadow:0 0 10px rgba(255,215,0,0.4)}
.total-bet{font-family:'Orbitron';font-size:0.85rem;color:var(--magenta)}
/* History */
.history{padding:12px}
.history h3{color:var(--cyan);font-size:0.8rem;margin-bottom:8px;letter-spacing:2px}
.history-list{display:flex;gap:5px;flex-wrap:wrap}
.history-item{width:30px;height:30px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-family:'Orbitron';font-size:0.55rem;font-weight:700;border:2px solid rgba(255,255,255,0.2)}
.history-item.red{background:rgba(200,30,30,0.7);border-color:#ff4444}
.history-item.black{background:rgba(40,40,40,0.9);border-color:#888}
.history-item.green{background:rgba(0,150,60,0.7);border-color:#00ff88}
/* Message */
.message{text-align:center;padding:8px;font-size:0.85rem;min-height:2em;color:var(--cyan)}
.message.win{color:var(--gold);text-shadow:0 0 10px rgba(255,215,0,0.5)}
.message.lose{color:var(--magenta)}
/* Particles */
.particle{position:fixed;pointer-events:none;z-index:9999;border-radius:50%}
/* Big win overlay */
.bigwin-overlay{position:fixed;inset:0;z-index:10000;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.8);opacity:0;pointer-events:none;transition:opacity 0.3s}
.bigwin-overlay.show{opacity:1;pointer-events:auto}
.bigwin-content{text-align:center;animation:bigwinPulse 0.5s ease infinite alternate}
.bigwin-content h2{font-family:'Orbitron';font-size:clamp(2rem,8vw,4rem);background:linear-gradient(90deg,var(--gold),#fff,var(--gold));-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:10px}
.bigwin-content p{font-size:1.5rem;color:var(--gold)}
@keyframes bigwinPulse{from{transform:scale(1)}to{transform:scale(1.05)}}
/* Responsive */
@media(max-width:768px){
.left-panel{flex:0 0 100%}
.right-panel{flex:0 0 100%}
.wheel-container{width:250px;height:250px}
.number-grid{grid-template-columns:repeat(6,1fr)}
.num-btn.green-num{grid-column:span 6}
.outside-bets{grid-template-columns:repeat(2,1fr)}
}
</style>
</head>
<body>
<div class="container">
<header>
<h1>霓虹輪盤</h1>
<p>NEON ROULETTE</p>
</header>
<div class="main-layout">
<div class="left-panel">
<div class="glass" style="padding:15px;position:relative">
<div class="marker"></div>
<div class="wheel-container">
<div class="wheel-outer">
<svg class="wheel-svg" id="wheel" viewBox="0 0 300 300"></svg>
<div class="wheel-center">NEON<br>ROULETTE</div>
</div>
<div class="ball" id="ball"></div>
</div>
</div>
<div class="glass result-display" id="resultDisplay" style="display:none">
<div class="result-number" id="resultNumber">-</div>
<div class="result-text" id="resultText"></div>
</div>
<div class="glass history" id="historyPanel" style="display:none">
<h3>歷史紀錄</h3>
<div class="history-list" id="historyList"></div>
</div>
</div>
<div class="right-panel">
<div class="glass balance-bar">
<div><div class="balance-label">籌碼餘額</div><div class="balance-amount" id="balance">1000</div></div>
<div><div class="balance-label">目前下注</div><div class="total-bet" id="totalBet">0</div></div>
</div>
<div class="glass chip-selector">
<div class="chip chip-10 selected" data-value="10" onclick="selectChip(10)">10</div>
<div class="chip chip-50" data-value="50" onclick="selectChip(50)">50</div>
<div class="chip chip-100" data-value="100" onclick="selectChip(100)">100</div>
<div class="chip chip-500" data-value="500" onclick="selectChip(500)">500</div>
</div>
<div class="glass bet-table">
<h3>下注區</h3>
<div class="number-grid" id="numberGrid"></div>
<div class="outside-bets">
<div class="outside-btn red-bg" data-bet="red" onclick="placeBet('red')">紅</div>
<div class="outside-btn black-bg" data-bet="black" onclick="placeBet('black')">黑</div>
<div class="outside-btn" data-bet="odd" onclick="placeBet('odd')">單</div>
<div class="outside-btn" data-bet="even" onclick="placeBet('even')">雙</div>
<div class="outside-btn" data-bet="low" onclick="placeBet('low')">小 1-18</div>
<div class="outside-btn" data-bet="high" onclick="placeBet('high')">大 19-36</div>
</div>
</div>
<div class="controls">
<button class="btn btn-spin" id="spinBtn" onclick="spin()">旋轉</button>
<button class="btn btn-clear" onclick="clearBets()">清除</button>
</div>
<div class="message" id="message">選擇籌碼, 點擊下注區開始</div>
</div>
</div>
</div>
<div class="bigwin-overlay" id="bigwinOverlay" onclick="this.classList.remove('show')">
<div class="bigwin-content"><h2>大贏!</h2><p id="bigwinAmount"></p></div>
</div>
<script>
// European roulette wheel order
const WHEEL_ORDER=[0,32,15,19,4,21,2,25,17,34,6,27,13,36,11,30,8,23,10,5,24,16,33,1,20,14,31,9,22,18,29,7,28,12,35,3,26];
const RED_NUMBERS=[1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36];
function isRed(n){return RED_NUMBERS.includes(n)}
function getColor(n){return n===0?'green':isRed(n)?'red':'black'}

let balance=1000, selectedChip=10, bets={}, spinning=false, history=[];
let audioCtx=null;

function initAudio(){if(!audioCtx)audioCtx=new(window.AudioContext||window.webkitAudioContext)()}
function playTone(freq,dur,type,vol){
try{initAudio();const o=audioCtx.createOscillator(),g=audioCtx.createGain();o.type=type||'sine';o.frequency.value=freq;g.gain.value=vol||0.1;o.connect(g);g.connect(audioCtx.destination);o.start();g.gain.exponentialRampToValueAtTime(0.001,audioCtx.currentTime+dur);o.stop(audioCtx.currentTime+dur)}catch(e){}
}
function playSpinSound(){for(let i=0;i<8;i++)setTimeout(()=>playTone(800+i*100,0.15,'square',0.05),i*150)}
function playBallSound(){playTone(1200,0.1,'sine',0.15);setTimeout(()=>playTone(900,0.1,'sine',0.12),100);setTimeout(()=>playTone(600,0.15,'sine',0.1),200)}
function playWinSound(){[523,659,784,1047].forEach((f,i)=>setTimeout(()=>playTone(f,0.3,'sine',0.12),i*120))}

// Draw wheel
function drawWheel(){
const svg=document.getElementById('wheel');
const cx=150,cy=150,r=145,n=37,ang=360/n;
let html='';
WHEEL_ORDER.forEach((num,i)=>{
const a1=(i*ang-90)*Math.PI/180, a2=((i+1)*ang-90)*Math.PI/180;
const x1=cx+r*Math.cos(a1),y1=cy+r*Math.sin(a1);
const x2=cx+r*Math.cos(a2),y2=cy+r*Math.sin(a2);
const fill=num===0?'#00963c':isRed(num)?'#cc2222':'#222';
html+='<path d="M'+cx+','+cy+' L'+x1+','+y1+' A'+r+','+r+' 0 0,1 '+x2+','+y2+' Z" fill="'+fill+'" stroke="#444" stroke-width="0.5"/>';
const ta=(a1+a2)/2, tx=cx+(r*0.75)*Math.cos(ta), ty=cy+(r*0.75)*Math.sin(ta);
const rot=((i+0.5)*ang);
html+='<text x="'+tx+'" y="'+ty+'" fill="#fff" font-size="8" font-family="Orbitron" font-weight="700" text-anchor="middle" dominant-baseline="middle" transform="rotate('+rot+','+tx+','+ty+')">'+num+'</text>';
});
svg.innerHTML=html;
}

// Number grid
function buildGrid(){
const grid=document.getElementById('numberGrid');
let html='<div class="num-btn green-num" data-num="0" onclick="placeBet(0)">0</div>';
for(let i=1;i<=36;i++){
const c=isRed(i)?'red-num':'black-num';
html+='<div class="num-btn '+c+'" data-num="'+i+'" onclick="placeBet('+i+')">'+i+'</div>';
}
grid.innerHTML=html;
}

function selectChip(v){
selectedChip=v;
document.querySelectorAll('.chip').forEach(c=>{c.classList.toggle('selected',parseInt(c.dataset.value)===v)});
}

function placeBet(type){
if(spinning)return;
const key=typeof type==='number'?'n'+type:type;
const cost=selectedChip;
if(balance<cost){showMsg('籌碼不足!','lose');return}
if(!bets[key])bets[key]=0;
bets[key]+=cost;
balance-=cost;
updateUI();
}

function clearBets(){
if(spinning)return;
let total=Object.values(bets).reduce((s,v)=>s+v,0);
balance+=total;
bets={};
updateUI();
showMsg('已清除所有下注','');
}

function getTotalBet(){return Object.values(bets).reduce((s,v)=>s+v,0)}

function updateUI(){
document.getElementById('balance').textContent=balance;
document.getElementById('totalBet').textContent=getTotalBet();
// Update bet indicators on numbers
document.querySelectorAll('.num-btn').forEach(b=>{
const n=parseInt(b.dataset.num);
const key='n'+n;
b.classList.toggle('has-bet',!!bets[key]);
const old=b.querySelector('.bet-indicator');
if(old)old.remove();
if(bets[key]){const d=document.createElement('div');d.className='bet-indicator';d.textContent=bets[key];b.appendChild(d)}
});
document.querySelectorAll('.outside-btn').forEach(b=>{
const key=b.dataset.bet;
b.classList.toggle('has-bet',!!bets[key]);
});
}

function showMsg(t,cls){const m=document.getElementById('message');m.textContent=t;m.className='message'+(cls?' '+cls:'')}

function spin(){
if(spinning||getTotalBet()===0){if(getTotalBet()===0)showMsg('請先下注!','lose');return}
spinning=true;
document.getElementById('spinBtn').disabled=true;
initAudio();
playSpinSound();
const result=WHEEL_ORDER[Math.floor(Math.random()*37)];
const idx=WHEEL_ORDER.indexOf(result);
const segAngle=360/37;
const targetAngle=360-(idx*segAngle+segAngle/2);
const totalRotation=360*5+targetAngle;
const wheel=document.getElementById('wheel');
const ball=document.getElementById('ball');
wheel.style.transition='none';
wheel.style.transform='rotate(0deg)';
void wheel.offsetHeight;
wheel.classList.add('spinning');
wheel.style.transition='transform 4s cubic-bezier(0.17,0.67,0.12,0.99)';
wheel.style.transform='rotate('+totalRotation+'deg)';
// Ball animation
ball.className='ball show orbiting';
setTimeout(()=>{
ball.className='ball show';
// The wheel rotated so the winning segment aligns with the top marker
// Ball lands at top (marker position), radius 120px from center
const br=120;
ball.style.transition='none';
ball.style.left='50%';
ball.style.top='50%';
ball.style.margin='-6px';
void ball.offsetHeight;
ball.style.transition='all 0.5s ease-out';
ball.style.transform='translateY(-'+br+'px)';
playBallSound();
},3200);
setTimeout(()=>resolve(result),4500);
}

function resolve(num){
spinning=false;
document.getElementById('spinBtn').disabled=false;
const ball=document.getElementById('ball');
ball.className='ball';ball.style.transform='';ball.style.transition='';
const color=getColor(num);
const rd=document.getElementById('resultDisplay');
rd.style.display='block';
const rn=document.getElementById('resultNumber');
rn.textContent=num;
rn.className='result-number '+color;
const isEven=num>0&&num%2===0;
const isOdd=num>0&&num%2===1;
const isLow=num>=1&&num<=18;
const isHigh=num>=19&&num<=36;
const isRedN=isRed(num);
let desc=num===0?'綠色':((isRedN?'紅':'黑')+' '+(isOdd?'單':'雙')+' '+(isHigh?'大':'小'));
document.getElementById('resultText').textContent=desc;
// Calculate winnings
let winnings=0;
Object.keys(bets).forEach(key=>{
const amt=bets[key];
if(key==='red'&&isRedN)winnings+=amt*2;
else if(key==='black'&&!isRedN&&num!==0)winnings+=amt*2;
else if(key==='odd'&&isOdd)winnings+=amt*2;
else if(key==='even'&&isEven)winnings+=amt*2;
else if(key==='low'&&isLow)winnings+=amt*2;
else if(key==='high'&&isHigh)winnings+=amt*2;
else if(key==='n'+num)winnings+=amt*36;
});
balance+=winnings;
const totalBet=getTotalBet();
const profit=winnings-totalBet;
if(winnings>0){
showMsg('贏得 '+winnings+' 籌碼! (利潤: '+(profit>0?'+':'')+profit+')','win');
playWinSound();
spawnParticles(30);
if(winnings>=totalBet*10)bigWin(winnings);
}else{
showMsg('未中獎, 損失 '+totalBet+' 籌碼','lose');
}
// History
history.unshift({num:num,color:color});
if(history.length>10)history.pop();
renderHistory();
bets={};
updateUI();
if(balance<=0){setTimeout(()=>{balance=1000;updateUI();showMsg('籌碼歸零! 已重新發放 1000 籌碼','')},2000)}
}

function renderHistory(){
const hp=document.getElementById('historyPanel');
hp.style.display='block';
const hl=document.getElementById('historyList');
hl.innerHTML=history.map(h=>'<div class="history-item '+h.color+'">'+h.num+'</div>').join('');
}

function spawnParticles(count){
const colors=['#00f0ff','#ff2d95','#b026ff','#ffd700','#00ff88'];
for(let i=0;i<count;i++){
const p=document.createElement('div');
p.className='particle';
p.style.cssText='left:'+Math.random()*100+'vw;top:'+Math.random()*100+'vh;width:6px;height:6px;background:'+colors[i%colors.length]+';opacity:1;transition:all '+(1+Math.random())+'s ease-out;';
document.body.appendChild(p);
requestAnimationFrame(()=>{p.style.transform='translateY('+(-(50+Math.random()*100))+'px) scale(0)';p.style.opacity='0'});
setTimeout(()=>p.remove(),2000);
}
}

function bigWin(amount){
const ov=document.getElementById('bigwinOverlay');
document.getElementById('bigwinAmount').textContent='+'+amount+' 籌碼!';
ov.classList.add('show');
spawnParticles(80);
for(let i=0;i<5;i++)setTimeout(()=>playTone(523*(1+i*0.25),0.4,'sine',0.1),i*200);
setTimeout(()=>ov.classList.remove('show'),3500);
}

drawWheel();
buildGrid();
updateUI();
</script>
</body>
</html>
